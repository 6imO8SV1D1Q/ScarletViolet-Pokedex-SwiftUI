# ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆæ©Ÿèƒ½ è¨­è¨ˆæ›¸

**ä½œæˆæ—¥**: 2025-11-09
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: ãƒã‚±ãƒ¢ãƒ³ ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆå¯¾å¿œç‰ˆ
**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: Clean Architecture (SwiftUI + SwiftData)

---

## ğŸ“‹ è¦ä»¶å®šç¾©

### 1. æ©Ÿèƒ½æ¦‚è¦

ãƒã‚±ãƒ¢ãƒ³ ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆå¯¾å¿œã®ãƒ‘ãƒ¼ãƒ†ã‚£ï¼ˆæœ€å¤§6åŒ¹ï¼‰ã‚’ç·¨æˆãƒ»ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

### 2. ä¸»è¦è¦ä»¶

#### 2.1 ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆæ©Ÿèƒ½

- æœ€å¤§6åŒ¹ã®ãƒã‚±ãƒ¢ãƒ³ã‚’ãƒ‘ãƒ¼ãƒ†ã‚£ã«ç™»éŒ²
- ãƒã‚±ãƒ¢ãƒ³ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆ
- å„ãƒã‚±ãƒ¢ãƒ³ã®è©³ç´°è¨­å®šï¼š
  - **ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—é¸æŠï¼ˆ18ã‚¿ã‚¤ãƒ—ã‹ã‚‰é¸æŠï¼‰** â­ æœ€é‡è¦
  - ãƒ•ã‚©ãƒ¼ãƒ é¸æŠï¼ˆãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã®ã¿ï¼‰
  - æŠ€4ã¤é¸æŠ
  - ç‰¹æ€§é¸æŠ
  - æŒã¡ç‰©è¨­å®š
  - æ€§æ ¼ãƒ»å€‹ä½“å€¤ãƒ»åŠªåŠ›å€¤è¨­å®š
  - ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  - ãƒ¬ãƒ™ãƒ«è¨­å®šï¼ˆ1-100ï¼‰

#### 2.2 ãƒ‘ãƒ¼ãƒ†ã‚£ç®¡ç†æ©Ÿèƒ½

- è¤‡æ•°ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’ä¿å­˜ãƒ»ç®¡ç†
- ãƒ‘ãƒ¼ãƒ†ã‚£åç§°ã®è¨­å®š
- ãƒ‘ãƒ¼ãƒ†ã‚£ã®è¤‡è£½ãƒ»å‰Šé™¤
- ãƒ‘ãƒ¼ãƒ†ã‚£ä¸€è¦§è¡¨ç¤ºï¼ˆãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—è¡¨ç¤ºå«ã‚€ï¼‰

#### 2.3 ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«å¯¾å¿œæ©Ÿèƒ½

- ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—è¡¨ç¤ºï¼ˆè¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ãï¼‰
- ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æã§ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«ã‚’è€ƒæ…®
- ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«å¾Œã®ã‚¿ã‚¤ãƒ—ä¸€è‡´æŠ€ã®ç¢ºèª

#### 2.4 é€£æºæ©Ÿèƒ½

- ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—æ©Ÿã¸ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆãƒ†ãƒ©ã‚¹ã‚¿ãƒ«è¾¼ã¿ï¼‰
- èƒ½åŠ›å€¤è¨ˆç®—æ©Ÿã¨ã®é€£æº
- ãƒã‚±ãƒ¢ãƒ³æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ã®æ´»ç”¨

### 3. éæ©Ÿèƒ½è¦ä»¶

- SwiftDataã§ãƒ­ãƒ¼ã‚«ãƒ«æ°¸ç¶šåŒ–
- æ—¢å­˜ã®Clean Architectureæ§‹é€ ã«æº–æ‹ 
- iOS 17.0ä»¥ä¸Šå¯¾å¿œ
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- æ—¥æœ¬èªãƒ»è‹±èªãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

### 4. ã‚¹ã‚³ãƒ¼ãƒ—å¤–

- ãƒ¡ã‚¬ã‚·ãƒ³ã‚«ï¼ˆç¬¬6ä¸–ä»£ï¼‰
- ãƒ€ã‚¤ãƒãƒƒã‚¯ã‚¹ï¼ˆç¬¬8ä¸–ä»£ï¼‰
- ãã®ä»–ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆä»¥å¤–ã®è¦ç´ 

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 1. ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

Clean Architectureã®3å±¤æ§‹é€ ã«å¾“ã„ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Presentation Layer (SwiftUI)      â”‚
â”‚   - Views                            â”‚
â”‚   - ViewModels (@MainActor)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Domain Layer (Pure Swift)          â”‚
â”‚   - Entities                         â”‚
â”‚   - UseCases                         â”‚
â”‚   - Repository Protocols             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Layer                         â”‚
â”‚   - SwiftData Models                 â”‚
â”‚   - Repository Implementations       â”‚
â”‚   - Data Mappers                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Domain Layer è¨­è¨ˆ

### 1. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾©

#### 1.1 Partyï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£å…¨ä½“ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/Party.swift`

```swift
struct Party: Identifiable, Codable, Hashable {
    let id: UUID
    var name: String
    var members: [PartyMember]  // æœ€å¤§6
    var createdAt: Date
    var updatedAt: Date

    // Computed Properties
    var typeAnalysis: TypeCoverage
    var teraTypeDistribution: [String: Int]  // ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ã®åˆ†å¸ƒ
    var averageLevel: Double
    var isFull: Bool { members.count == 6 }
}
```

#### 1.2 PartyMemberï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/PartyMember.swift`

```swift
struct PartyMember: Identifiable, Codable, Hashable {
    let id: UUID
    let pokemonId: Int
    var nickname: String?
    var formId: Int?  // ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã®ã¿
    var selectedMoves: [SelectedMove]  // æœ€å¤§4
    var ability: String
    var item: String?
    var nature: Nature
    var evs: StatValues
    var ivs: StatValues
    var level: Int  // 1-100
    var teraType: String  // â­ ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ï¼ˆ18ã‚¿ã‚¤ãƒ—ã‹ã‚‰é¸æŠï¼‰
    var position: Int  // 0-5

    // Computed Properties
    var originalTypes: [String]  // å…ƒã®ã‚¿ã‚¤ãƒ—
    var teraTypeMatchesMoves: Bool  // ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãŒæŠ€ã¨ä¸€è‡´ã™ã‚‹ã‹
    var calculatedStats: StatValues  // å®Ÿæ•°å€¤
}
```

#### 1.3 SelectedMoveï¼ˆé¸æŠã•ã‚ŒãŸæŠ€ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/PartyMember.swift`

```swift
struct SelectedMove: Codable, Hashable {
    let moveName: String
    let moveType: String  // æŠ€ã®ã‚¿ã‚¤ãƒ—
    let slot: Int  // 0-3
    let power: Int?
    let accuracy: Int?
    let pp: Int
}
```

#### 1.4 Natureï¼ˆæ€§æ ¼ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/Nature.swift`

```swift
enum Nature: String, Codable, CaseIterable {
    // æ”»æ’ƒâ†‘
    case lonely   // é˜²å¾¡â†“
    case brave    // ç´ æ—©ã•â†“
    case adamant  // ç‰¹æ”»â†“
    case naughty  // ç‰¹é˜²â†“

    // é˜²å¾¡â†‘
    case bold     // æ”»æ’ƒâ†“
    case relaxed  // ç´ æ—©ã•â†“
    case impish   // ç‰¹æ”»â†“
    case lax      // ç‰¹é˜²â†“

    // ç‰¹æ”»â†‘
    case modest   // æ”»æ’ƒâ†“
    case mild     // é˜²å¾¡â†“
    case quiet    // ç´ æ—©ã•â†“
    case rash     // ç‰¹é˜²â†“

    // ç‰¹é˜²â†‘
    case calm     // æ”»æ’ƒâ†“
    case gentle   // é˜²å¾¡â†“
    case sassy    // ç´ æ—©ã•â†“
    case careful  // ç‰¹æ”»â†“

    // ç´ æ—©ã•â†‘
    case timid    // æ”»æ’ƒâ†“
    case hasty    // é˜²å¾¡â†“
    case jolly    // ç‰¹æ”»â†“
    case naive    // ç‰¹é˜²â†“

    // è£œæ­£ãªã—
    case hardy, docile, serious, bashful, quirky

    var displayName: String { /* ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚º */ }
    var displayNameJa: String { /* æ—¥æœ¬èªå */ }

    var statModifiers: (increased: StatType?, decreased: StatType?) {
        // æ€§æ ¼è£œæ­£ãƒ­ã‚¸ãƒƒã‚¯
    }
}

enum StatType: String, Codable {
    case attack, defense, specialAttack, specialDefense, speed
}
```

#### 1.5 StatValuesï¼ˆèƒ½åŠ›å€¤ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/StatValues.swift`

```swift
struct StatValues: Codable, Hashable {
    var hp: Int
    var attack: Int
    var defense: Int
    var specialAttack: Int
    var specialDefense: Int
    var speed: Int

    static var maxEVs: StatValues {
        StatValues(hp: 252, attack: 252, defense: 252,
                  specialAttack: 252, specialDefense: 252, speed: 252)
    }

    static var maxIVs: StatValues {
        StatValues(hp: 31, attack: 31, defense: 31,
                  specialAttack: 31, specialDefense: 31, speed: 31)
    }

    static var zero: StatValues {
        StatValues(hp: 0, attack: 0, defense: 0,
                  specialAttack: 0, specialDefense: 0, speed: 0)
    }

    var total: Int {
        hp + attack + defense + specialAttack + specialDefense + speed
    }
}
```

#### 1.6 TeraTypeï¼ˆãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/TeraType.swift`

```swift
/// ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆã®ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—å®šç¾©
enum TeraType: String, CaseIterable, Codable {
    case normal
    case fire
    case water
    case electric
    case grass
    case ice
    case fighting
    case poison
    case ground
    case flying
    case psychic
    case bug
    case rock
    case ghost
    case dragon
    case dark
    case steel
    case fairy

    /// ã‚¿ã‚¤ãƒ—ã®æ—¥æœ¬èªå
    var nameJa: String {
        switch self {
        case .normal: return "ãƒãƒ¼ãƒãƒ«"
        case .fire: return "ã»ã®ãŠ"
        case .water: return "ã¿ãš"
        case .electric: return "ã§ã‚“ã"
        case .grass: return "ãã•"
        case .ice: return "ã“ãŠã‚Š"
        case .fighting: return "ã‹ãã¨ã†"
        case .poison: return "ã©ã"
        case .ground: return "ã˜ã‚ã‚“"
        case .flying: return "ã²ã“ã†"
        case .psychic: return "ã‚¨ã‚¹ãƒ‘ãƒ¼"
        case .bug: return "ã‚€ã—"
        case .rock: return "ã„ã‚"
        case .ghost: return "ã‚´ãƒ¼ã‚¹ãƒˆ"
        case .dragon: return "ãƒ‰ãƒ©ã‚´ãƒ³"
        case .dark: return "ã‚ã"
        case .steel: return "ã¯ãŒã­"
        case .fairy: return "ãƒ•ã‚§ã‚¢ãƒªãƒ¼"
        }
    }

    /// ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«ã®ã‚·ãƒ³ãƒœãƒ«ã‚«ãƒ©ãƒ¼
    var color: Color {
        // æ—¢å­˜ã®PokemonTypeColorã‚’æ´»ç”¨
        PokemonTypeColor.color(for: self.rawValue)
    }

    /// å…¨ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ã®ãƒªã‚¹ãƒˆ
    static var allTypes: [String] {
        TeraType.allCases.map { $0.rawValue }
    }
}
```

#### 1.7 TypeCoverageï¼ˆã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Entities/TypeCoverage.swift`

```swift
struct TypeCoverage: Codable, Hashable {
    var weaknesses: [String: Int]    // ã‚¿ã‚¤ãƒ—: å¼±ç‚¹æ•°
    var resistances: [String: Int]   // ã‚¿ã‚¤ãƒ—: è€æ€§æ•°
    var immunities: Set<String>      // ç„¡åŠ¹ã‚¿ã‚¤ãƒ—
    var coverageScore: Double        // æ”»æ’ƒç¯„å›²ã‚¹ã‚³ã‚¢ (0.0-1.0)
}
```

### 2. Repository Protocols

#### 2.1 PartyRepositoryProtocol

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/Interfaces/PartyRepositoryProtocol.swift`

```swift
protocol PartyRepositoryProtocol {
    /// ã™ã¹ã¦ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’å–å¾—
    func fetchAllParties() async throws -> [Party]

    /// ç‰¹å®šã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’å–å¾—
    func fetchParty(id: UUID) async throws -> Party?

    /// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’ä¿å­˜ï¼ˆæ–°è¦/æ›´æ–°ï¼‰
    func saveParty(_ party: Party) async throws

    /// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’å‰Šé™¤
    func deleteParty(id: UUID) async throws

    /// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’è¤‡è£½
    func duplicateParty(id: UUID) async throws -> Party
}
```

### 3. Use Cases

#### 3.1 FetchPartiesUseCase

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/UseCases/Party/FetchPartiesUseCase.swift`

```swift
protocol FetchPartiesUseCaseProtocol {
    func execute() async throws -> [Party]
}

final class FetchPartiesUseCase: FetchPartiesUseCaseProtocol {
    private let repository: PartyRepositoryProtocol

    init(repository: PartyRepositoryProtocol) {
        self.repository = repository
    }

    func execute() async throws -> [Party] {
        try await repository.fetchAllParties()
    }
}
```

#### 3.2 SavePartyUseCase

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/UseCases/Party/SavePartyUseCase.swift`

```swift
protocol SavePartyUseCaseProtocol {
    func execute(_ party: Party) async throws
}

final class SavePartyUseCase: SavePartyUseCaseProtocol {
    private let repository: PartyRepositoryProtocol

    init(repository: PartyRepositoryProtocol) {
        self.repository = repository
    }

    func execute(_ party: Party) async throws {
        var updatedParty = party
        updatedParty.updatedAt = Date()
        try await repository.saveParty(updatedParty)
    }
}
```

#### 3.3 DeletePartyUseCase

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/UseCases/Party/DeletePartyUseCase.swift`

```swift
protocol DeletePartyUseCaseProtocol {
    func execute(id: UUID) async throws
}

final class DeletePartyUseCase: DeletePartyUseCaseProtocol {
    private let repository: PartyRepositoryProtocol

    init(repository: PartyRepositoryProtocol) {
        self.repository = repository
    }

    func execute(id: UUID) async throws {
        try await repository.deleteParty(id: id)
    }
}
```

#### 3.4 AnalyzePartyUseCase

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Domain/UseCases/Party/AnalyzePartyUseCase.swift`

```swift
protocol AnalyzePartyUseCaseProtocol {
    func execute(_ party: Party) async -> TypeCoverage
}

final class AnalyzePartyUseCase: AnalyzePartyUseCaseProtocol {
    private let typeRepository: TypeRepositoryProtocol

    init(typeRepository: TypeRepositoryProtocol) {
        self.typeRepository = typeRepository
    }

    func execute(_ party: Party) async -> TypeCoverage {
        // ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æãƒ­ã‚¸ãƒƒã‚¯
        // å¼±ç‚¹ãƒ»è€æ€§ãƒ»ç„¡åŠ¹ã®é›†è¨ˆ
        // ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«è€ƒæ…®
    }
}
```

---

## ğŸ’¾ Data Layer è¨­è¨ˆ

### 1. SwiftData Models

#### 1.1 PartyModel

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Data/Persistence/PartyModel.swift`

```swift
import Foundation
import SwiftData

@Model
final class PartyModel {
    @Attribute(.unique) var id: UUID
    var name: String
    var members: [PartyMemberModel]
    var createdAt: Date
    var updatedAt: Date

    init(id: UUID, name: String, members: [PartyMemberModel],
         createdAt: Date, updatedAt: Date) {
        self.id = id
        self.name = name
        self.members = members
        self.createdAt = createdAt
        self.updatedAt = updatedAt
    }
}
```

#### 1.2 PartyMemberModel

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Data/Persistence/PartyMemberModel.swift`

```swift
import Foundation
import SwiftData

@Model
final class PartyMemberModel {
    var id: UUID
    var pokemonId: Int
    var nickname: String?
    var formId: Int?
    var selectedMoves: Data  // JSON encoded [SelectedMove]
    var ability: String
    var item: String?
    var nature: String
    var evs: Data  // JSON encoded StatValues
    var ivs: Data  // JSON encoded StatValues
    var level: Int
    var teraType: String  // â­ ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—
    var position: Int

    init(id: UUID, pokemonId: Int, nickname: String? = nil,
         formId: Int? = nil, selectedMoves: Data, ability: String,
         item: String? = nil, nature: String, evs: Data, ivs: Data,
         level: Int, teraType: String, position: Int) {
        self.id = id
        self.pokemonId = pokemonId
        self.nickname = nickname
        self.formId = formId
        self.selectedMoves = selectedMoves
        self.ability = ability
        self.item = item
        self.nature = nature
        self.evs = evs
        self.ivs = ivs
        self.level = level
        self.teraType = teraType
        self.position = position
    }
}
```

### 2. Repository Implementation

#### 2.1 PartyRepository

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Data/Repositories/PartyRepository.swift`

```swift
import Foundation
import SwiftData

final class PartyRepository: PartyRepositoryProtocol {
    private let modelContext: ModelContext

    init(modelContext: ModelContext) {
        self.modelContext = modelContext
    }

    func fetchAllParties() async throws -> [Party] {
        let descriptor = FetchDescriptor<PartyModel>(
            sortBy: [SortDescriptor(\.updatedAt, order: .reverse)]
        )
        let models = try modelContext.fetch(descriptor)
        return models.map { PartyMapper.toDomain($0) }
    }

    func fetchParty(id: UUID) async throws -> Party? {
        let predicate = #Predicate<PartyModel> { $0.id == id }
        var descriptor = FetchDescriptor(predicate: predicate)
        descriptor.fetchLimit = 1

        let models = try modelContext.fetch(descriptor)
        return models.first.map { PartyMapper.toDomain($0) }
    }

    func saveParty(_ party: Party) async throws {
        // æ—¢å­˜ãƒã‚§ãƒƒã‚¯
        if let existing = try await fetchParty(id: party.id) {
            // æ›´æ–°
            let model = PartyMapper.toModel(party)
            modelContext.insert(model)
        } else {
            // æ–°è¦
            let model = PartyMapper.toModel(party)
            modelContext.insert(model)
        }
        try modelContext.save()
    }

    func deleteParty(id: UUID) async throws {
        let predicate = #Predicate<PartyModel> { $0.id == id }
        try modelContext.delete(model: PartyModel.self, where: predicate)
        try modelContext.save()
    }

    func duplicateParty(id: UUID) async throws -> Party {
        guard let original = try await fetchParty(id: id) else {
            throw PartyError.notFound
        }

        var duplicated = original
        duplicated.id = UUID()
        duplicated.name = "\(original.name) (Copy)"
        duplicated.createdAt = Date()
        duplicated.updatedAt = Date()

        // ãƒ¡ãƒ³ãƒãƒ¼ã®IDã‚‚å†ç”Ÿæˆ
        duplicated.members = duplicated.members.map { member in
            var newMember = member
            newMember.id = UUID()
            return newMember
        }

        try await saveParty(duplicated)
        return duplicated
    }
}

enum PartyError: Error {
    case notFound
    case invalidData
}
```

### 3. Data Mappers

#### 3.1 PartyMapper

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Data/DTOs/PartyMapper.swift`

```swift
import Foundation

enum PartyMapper {
    static func toDomain(_ model: PartyModel) -> Party {
        Party(
            id: model.id,
            name: model.name,
            members: model.members.map { PartyMemberMapper.toDomain($0) },
            createdAt: model.createdAt,
            updatedAt: model.updatedAt
        )
    }

    static func toModel(_ domain: Party) -> PartyModel {
        PartyModel(
            id: domain.id,
            name: domain.name,
            members: domain.members.map { PartyMemberMapper.toModel($0) },
            createdAt: domain.createdAt,
            updatedAt: domain.updatedAt
        )
    }
}
```

#### 3.2 PartyMemberMapper

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Data/DTOs/PartyMemberMapper.swift`

```swift
import Foundation

enum PartyMemberMapper {
    static func toDomain(_ model: PartyMemberModel) -> PartyMember {
        let moves = try? JSONDecoder().decode([SelectedMove].self, from: model.selectedMoves)
        let evs = try? JSONDecoder().decode(StatValues.self, from: model.evs)
        let ivs = try? JSONDecoder().decode(StatValues.self, from: model.ivs)

        return PartyMember(
            id: model.id,
            pokemonId: model.pokemonId,
            nickname: model.nickname,
            formId: model.formId,
            selectedMoves: moves ?? [],
            ability: model.ability,
            item: model.item,
            nature: Nature(rawValue: model.nature) ?? .hardy,
            evs: evs ?? .zero,
            ivs: ivs ?? .maxIVs,
            level: model.level,
            teraType: model.teraType,
            position: model.position
        )
    }

    static func toModel(_ domain: PartyMember) -> PartyMemberModel {
        let movesData = try? JSONEncoder().encode(domain.selectedMoves)
        let evsData = try? JSONEncoder().encode(domain.evs)
        let ivsData = try? JSONEncoder().encode(domain.ivs)

        return PartyMemberModel(
            id: domain.id,
            pokemonId: domain.pokemonId,
            nickname: domain.nickname,
            formId: domain.formId,
            selectedMoves: movesData ?? Data(),
            ability: domain.ability,
            item: domain.item,
            nature: domain.nature.rawValue,
            evs: evsData ?? Data(),
            ivs: ivsData ?? Data(),
            level: domain.level,
            teraType: domain.teraType,
            position: domain.position
        )
    }
}
```

---

## ğŸ¨ Presentation Layer è¨­è¨ˆ

### 1. ç”»é¢æ§‹æˆ

```
PartyListView (ãƒ‘ãƒ¼ãƒ†ã‚£ä¸€è¦§)
    â”œâ”€ PartyCardView (å„ãƒ‘ãƒ¼ãƒ†ã‚£ã‚«ãƒ¼ãƒ‰)
    â”‚   â”œâ”€ ãƒ‘ãƒ¼ãƒ†ã‚£å
    â”‚   â”œâ”€ ãƒ¡ãƒ³ãƒãƒ¼è¡¨ç¤ºï¼ˆã‚¢ã‚¤ã‚³ãƒ³ + ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸ Ã— 6ï¼‰
    â”‚   â””â”€ ã‚¿ãƒƒãƒ— â†’ PartyFormationViewï¼ˆç·¨é›†ï¼‰
    â””â”€ FloatingActionButton: æ–°è¦ä½œæˆ
        â†“
PartyFormationView (ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆç”»é¢)
    â”œâ”€ NavigationBar
    â”‚   â”œâ”€ Title: ãƒ‘ãƒ¼ãƒ†ã‚£åç·¨é›†å¯èƒ½
    â”‚   â””â”€ Toolbar
    â”‚       â”œâ”€ ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    â”‚       â””â”€ ä¿å­˜
    â”œâ”€ PartyMemberSlotView Ã— 6
    â”‚   â”œâ”€ ãƒã‚±ãƒ¢ãƒ³ã‚¢ã‚¤ã‚³ãƒ³
    â”‚   â”œâ”€ ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸ â­
    â”‚   â”œâ”€ ãƒ¬ãƒ™ãƒ«è¡¨ç¤º
    â”‚   â””â”€ ã‚¿ãƒƒãƒ— â†’ PokemonSelectorView
    â”œâ”€ TypeAnalysisView (ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æ + ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«åˆ†æ)
    â””â”€ DeleteButtonï¼ˆæ—¢å­˜ãƒ‘ãƒ¼ãƒ†ã‚£ã®å ´åˆï¼‰
        â†“
PartyMemberEditorView (å€‹åˆ¥ãƒã‚±ãƒ¢ãƒ³è¨­å®š)
    â”œâ”€ NavigationBar: "ãƒã‚±ãƒ¢ãƒ³å"
    â”œâ”€ ScrollView
    â”‚   â”œâ”€ PokemonInfoSection
    â”‚   â”‚   â”œâ”€ ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆç”»åƒ
    â”‚   â”‚   â”œâ”€ ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ å…¥åŠ›
    â”‚   â”‚   â””â”€ ãƒ¬ãƒ™ãƒ«é¸æŠï¼ˆ1-100ï¼‰
    â”‚   â”œâ”€ TeraTypePicker â­ (18ã‚¿ã‚¤ãƒ—ã‹ã‚‰ãƒ”ãƒƒã‚«ãƒ¼)
    â”‚   â”œâ”€ FormPickerï¼ˆãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
    â”‚   â”œâ”€ AbilityPicker
    â”‚   â”œâ”€ ItemPicker
    â”‚   â”œâ”€ NaturePicker
    â”‚   â”œâ”€ MoveSelectorView Ã— 4
    â”‚   â””â”€ StatsConfigView (åŠªåŠ›å€¤/å€‹ä½“å€¤)
    â””â”€ Toolbar: å®Œäº†
```

### 2. ViewModels

#### 2.1 PartyListViewModel

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/PartyListViewModel.swift`

```swift
import Foundation
import Combine

@MainActor
final class PartyListViewModel: ObservableObject {
    // Published State
    @Published var parties: [Party] = []
    @Published var isLoading: Bool = false
    @Published var errorMessage: String?
    @Published var showingDeleteConfirmation: Bool = false
    @Published var partyToDelete: Party?

    // Dependencies
    private let fetchPartiesUseCase: FetchPartiesUseCaseProtocol
    private let deletePartyUseCase: DeletePartyUseCaseProtocol

    init(fetchPartiesUseCase: FetchPartiesUseCaseProtocol,
         deletePartyUseCase: DeletePartyUseCaseProtocol) {
        self.fetchPartiesUseCase = fetchPartiesUseCase
        self.deletePartyUseCase = deletePartyUseCase
    }

    func loadParties() async {
        isLoading = true
        defer { isLoading = false }

        do {
            parties = try await fetchPartiesUseCase.execute()
        } catch {
            errorMessage = error.localizedDescription
        }
    }

    func deleteParty(_ party: Party) async {
        do {
            try await deletePartyUseCase.execute(id: party.id)
            await loadParties()
        } catch {
            errorMessage = error.localizedDescription
        }
    }

    func confirmDelete(_ party: Party) {
        partyToDelete = party
        showingDeleteConfirmation = true
    }
}
```

#### 2.2 PartyFormationViewModel

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/PartyFormationViewModel.swift`

```swift
import Foundation
import Combine

@MainActor
final class PartyFormationViewModel: ObservableObject {
    // Published State
    @Published var party: Party
    @Published var isEditing: Bool = false
    @Published var selectedMemberIndex: Int?
    @Published var typeAnalysis: TypeCoverage?
    @Published var errorMessage: String?
    @Published var showingPokemonSelector: Bool = false
    @Published var showingMemberEditor: Bool = false

    // Dependencies
    private let savePartyUseCase: SavePartyUseCaseProtocol
    private let analyzePartyUseCase: AnalyzePartyUseCaseProtocol
    private let pokemonRepository: PokemonRepositoryProtocol

    init(party: Party? = nil,
         savePartyUseCase: SavePartyUseCaseProtocol,
         analyzePartyUseCase: AnalyzePartyUseCaseProtocol,
         pokemonRepository: PokemonRepositoryProtocol) {
        self.party = party ?? Party.empty
        self.savePartyUseCase = savePartyUseCase
        self.analyzePartyUseCase = analyzePartyUseCase
        self.pokemonRepository = pokemonRepository
    }

    func addPokemon(_ pokemon: Pokemon, at index: Int) {
        let member = PartyMember(
            id: UUID(),
            pokemonId: pokemon.id,
            nickname: nil,
            formId: nil,
            selectedMoves: [],
            ability: pokemon.abilities.first?.name ?? "",
            item: nil,
            nature: .hardy,
            evs: .zero,
            ivs: .maxIVs,
            level: 50,
            teraType: pokemon.types.first?.name ?? "normal",
            position: index
        )

        if index < party.members.count {
            party.members[index] = member
        } else {
            party.members.append(member)
        }

        Task { await analyzeTypeMatchups() }
    }

    func removePokemon(at index: Int) {
        guard index < party.members.count else { return }
        party.members.remove(at: index)
        Task { await analyzeTypeMatchups() }
    }

    func movePokemon(from source: Int, to destination: Int) {
        party.members.move(fromOffsets: IndexSet(integer: source),
                          toOffset: destination)
        // ä½ç½®ã‚’å†è¨ˆç®—
        for (index, _) in party.members.enumerated() {
            party.members[index].position = index
        }
    }

    func saveParty() async throws {
        party.updatedAt = Date()
        try await savePartyUseCase.execute(party)
    }

    func analyzeTypeMatchups() async {
        typeAnalysis = await analyzePartyUseCase.execute(party)
    }

    func selectMember(at index: Int) {
        selectedMemberIndex = index
        showingMemberEditor = true
    }
}
```

#### 2.3 PartyMemberEditorViewModel

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/PartyMemberEditorViewModel.swift`

```swift
import Foundation
import Combine

@MainActor
final class PartyMemberEditorViewModel: ObservableObject {
    // Published State
    @Published var member: PartyMember
    @Published var pokemon: Pokemon?
    @Published var availableForms: [PokemonForm] = []
    @Published var availableMoves: [Move] = []
    @Published var selectedForm: PokemonForm?

    // Dependencies
    private let pokemonRepository: PokemonRepositoryProtocol
    private let moveRepository: MoveRepositoryProtocol

    init(member: PartyMember,
         pokemonRepository: PokemonRepositoryProtocol,
         moveRepository: MoveRepositoryProtocol) {
        self.member = member
        self.pokemonRepository = pokemonRepository
        self.moveRepository = moveRepository
    }

    func loadPokemonData() async {
        do {
            pokemon = try await pokemonRepository.fetchPokemonDetail(id: member.pokemonId)
            if let pokemon = pokemon {
                availableForms = try await pokemonRepository.fetchPokemonForms(pokemonId: pokemon.id)
                availableMoves = pokemon.moves.compactMap { /* Moveå–å¾— */ }
            }
        } catch {
            // ã‚¨ãƒ©ãƒ¼å‡¦ç†
        }
    }

    func updateTeraType(_ type: String) {
        member.teraType = type
    }

    func updateMove(_ move: SelectedMove, at slot: Int) {
        if slot < member.selectedMoves.count {
            member.selectedMoves[slot] = move
        } else {
            member.selectedMoves.append(move)
        }
    }
}
```

### 3. Views

#### 3.1 PartyListView

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/PartyListView.swift`

```swift
import SwiftUI

struct PartyListView: View {
    @StateObject var viewModel: PartyListViewModel
    @State private var showingNewPartySheet = false

    var body: some View {
        ZStack {
            if viewModel.parties.isEmpty {
                EmptyPartyView {
                    showingNewPartySheet = true
                }
            } else {
                ScrollView {
                    LazyVStack(spacing: 16) {
                        ForEach(viewModel.parties) { party in
                            NavigationLink(destination: PartyFormationView(party: party)) {
                                PartyCardView(party: party)
                            }
                            .buttonStyle(.plain)
                            .contextMenu {
                                Button(role: .destructive) {
                                    viewModel.confirmDelete(party)
                                } label: {
                                    Label("Delete", systemImage: "trash")
                                }
                            }
                        }
                    }
                    .padding()
                }
            }

            // Floating Action Button
            VStack {
                Spacer()
                HStack {
                    Spacer()
                    Button {
                        showingNewPartySheet = true
                    } label: {
                        Image(systemName: "plus")
                            .font(.title2)
                            .foregroundColor(.white)
                            .frame(width: 60, height: 60)
                            .background(Color.accentColor)
                            .clipShape(Circle())
                            .shadow(radius: 4)
                    }
                    .padding()
                }
            }
        }
        .navigationTitle("Parties")
        .sheet(isPresented: $showingNewPartySheet) {
            PartyFormationView(party: nil)
        }
        .confirmationDialog(
            "Delete Party?",
            isPresented: $viewModel.showingDeleteConfirmation,
            presenting: viewModel.partyToDelete
        ) { party in
            Button("Delete", role: .destructive) {
                Task {
                    await viewModel.deleteParty(party)
                }
            }
        }
        .task {
            await viewModel.loadParties()
        }
    }
}
```

#### 3.2 PartyCardView

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/Components/PartyCardView.swift`

```swift
import SwiftUI

struct PartyCardView: View {
    let party: Party

    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            // ãƒ˜ãƒƒãƒ€ãƒ¼
            HStack {
                Text(party.name)
                    .font(.headline)
                Spacer()
                Text(party.updatedAt, style: .date)
                    .font(.caption)
                    .foregroundColor(.secondary)
            }

            // ãƒ¡ãƒ³ãƒãƒ¼è¡¨ç¤º
            LazyVGrid(columns: [
                GridItem(.adaptive(minimum: 80), spacing: 8)
            ], spacing: 8) {
                ForEach(0..<6, id: \.self) { index in
                    if index < party.members.count {
                        PartyMemberThumbnail(member: party.members[index])
                    } else {
                        EmptySlotView()
                    }
                }
            }

            // çµ±è¨ˆæƒ…å ±
            HStack {
                Label("\(party.members.count)/6", systemImage: "person.3.fill")
                    .font(.caption)
                Spacer()
                if let analysis = party.typeAnalysis {
                    Text("Coverage: \(Int(analysis.coverageScore * 100))%")
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
            }
        }
        .padding()
        .background(Color(.systemBackground))
        .cornerRadius(12)
        .shadow(radius: 2)
    }
}

struct PartyMemberThumbnail: View {
    let member: PartyMember

    var body: some View {
        VStack(spacing: 4) {
            ZStack(alignment: .bottomTrailing) {
                // ãƒã‚±ãƒ¢ãƒ³ã‚¢ã‚¤ã‚³ãƒ³
                AsyncImage(url: URL(string: member.spriteURL ?? "")) { image in
                    image.resizable()
                } placeholder: {
                    Color.gray.opacity(0.2)
                }
                .frame(width: 60, height: 60)
                .background(Color(.systemGray6))
                .cornerRadius(8)

                // ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸
                TeraTypeBadge(teraType: member.teraType)
                    .offset(x: 4, y: 4)
            }

            Text("Lv.\(member.level)")
                .font(.caption2)
                .foregroundColor(.secondary)
        }
    }
}

struct EmptySlotView: View {
    var body: some View {
        RoundedRectangle(cornerRadius: 8)
            .stroke(style: StrokeStyle(lineWidth: 2, dash: [5]))
            .foregroundColor(.secondary.opacity(0.3))
            .frame(width: 60, height: 60)
    }
}
```

#### 3.3 TeraTypePicker

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/Components/TeraTypePicker.swift`

```swift
import SwiftUI

struct TeraTypePicker: View {
    @Binding var selectedTeraType: String
    let pokemonTypes: [String]  // å…ƒã®ã‚¿ã‚¤ãƒ—

    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("Tera Type")
                .font(.headline)

            // ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã®ã‚ˆã†ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«
            LazyVGrid(columns: [
                GridItem(.adaptive(minimum: 70), spacing: 12)
            ], spacing: 12) {
                ForEach(TeraType.allCases, id: \.self) { type in
                    TeraTypeButton(
                        teraType: type,
                        isSelected: selectedTeraType == type.rawValue,
                        isPokemonOriginalType: pokemonTypes.contains(type.rawValue)
                    ) {
                        selectedTeraType = type.rawValue
                    }
                }
            }
        }
        .padding()
        .background(Color(.systemGray6))
        .cornerRadius(12)
    }
}

struct TeraTypeButton: View {
    let teraType: TeraType
    let isSelected: Bool
    let isPokemonOriginalType: Bool
    let action: () -> Void

    var body: some View {
        Button(action: action) {
            VStack(spacing: 4) {
                ZStack {
                    Circle()
                        .fill(teraType.color.opacity(0.2))
                        .frame(width: 56, height: 56)

                    // ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«ã‚¯ãƒªã‚¹ã‚¿ãƒ«é¢¨ã®ã‚¢ã‚¤ã‚³ãƒ³
                    Image(systemName: "diamond.fill")
                        .foregroundColor(teraType.color)
                        .font(.title2)

                    // ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¿ã‚¤ãƒ—ãƒãƒ¼ã‚«ãƒ¼
                    if isPokemonOriginalType {
                        Image(systemName: "star.fill")
                            .font(.caption2)
                            .foregroundColor(.yellow)
                            .offset(x: 18, y: -18)
                    }
                }
                .overlay(
                    Circle()
                        .stroke(isSelected ? Color.blue : Color.clear, lineWidth: 3)
                )

                Text(teraType.nameJa)
                    .font(.caption2)
                    .foregroundColor(.primary)
                    .lineLimit(1)
            }
        }
        .buttonStyle(.plain)
    }
}
```

#### 3.4 TeraTypeBadge

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Presentation/PartyFormation/Components/TeraTypeBadge.swift`

```swift
import SwiftUI

/// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¹ãƒ­ãƒƒãƒˆã«è¡¨ç¤ºã™ã‚‹å°ã•ãªãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸
struct TeraTypeBadge: View {
    let teraType: String
    let size: CGFloat = 24

    private var typeEnum: TeraType? {
        TeraType(rawValue: teraType)
    }

    var body: some View {
        ZStack {
            Circle()
                .fill(typeEnum?.color.opacity(0.3) ?? Color.gray.opacity(0.3))
                .frame(width: size, height: size)

            Image(systemName: "diamond.fill")
                .font(.system(size: size * 0.5))
                .foregroundColor(typeEnum?.color ?? .gray)
        }
        .overlay(
            Circle()
                .stroke(Color.white, lineWidth: 2)
        )
        .shadow(radius: 2)
    }
}
```

---

## ğŸ”Œ DIContainer çµ±åˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Application/DIContainer.swift` (æ‹¡å¼µ)

```swift
extension DIContainer {
    // MARK: - Party Repository
    private var partyRepository: PartyRepositoryProtocol {
        if _partyRepository == nil {
            guard let modelContext = modelContext else {
                fatalError("ModelContext not initialized")
            }
            _partyRepository = PartyRepository(modelContext: modelContext)
        }
        return _partyRepository!
    }

    // MARK: - Party UseCases
    func makeFetchPartiesUseCase() -> FetchPartiesUseCaseProtocol {
        FetchPartiesUseCase(repository: partyRepository)
    }

    func makeSavePartyUseCase() -> SavePartyUseCaseProtocol {
        SavePartyUseCase(repository: partyRepository)
    }

    func makeDeletePartyUseCase() -> DeletePartyUseCaseProtocol {
        DeletePartyUseCase(repository: partyRepository)
    }

    func makeAnalyzePartyUseCase() -> AnalyzePartyUseCaseProtocol {
        AnalyzePartyUseCase(typeRepository: typeRepository)
    }

    // MARK: - Party ViewModels
    func makePartyListViewModel() -> PartyListViewModel {
        PartyListViewModel(
            fetchPartiesUseCase: makeFetchPartiesUseCase(),
            deletePartyUseCase: makeDeletePartyUseCase()
        )
    }

    func makePartyFormationViewModel(party: Party? = nil) -> PartyFormationViewModel {
        PartyFormationViewModel(
            party: party,
            savePartyUseCase: makeSavePartyUseCase(),
            analyzePartyUseCase: makeAnalyzePartyUseCase(),
            pokemonRepository: pokemonRepository
        )
    }

    func makePartyMemberEditorViewModel(member: PartyMember) -> PartyMemberEditorViewModel {
        PartyMemberEditorViewModel(
            member: member,
            pokemonRepository: pokemonRepository,
            moveRepository: moveRepository
        )
    }
}
```

---

## ğŸ“± ã‚¢ãƒ—ãƒªçµ±åˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `PokedexApp.swift` (ä¿®æ­£)

```swift
import SwiftUI
import SwiftData

@main
struct PokedexApp: App {
    @StateObject private var container = DIContainer.shared

    var body: some Scene {
        WindowGroup {
            ContentView()
                .environmentObject(container)
        }
        .modelContainer(container.modelContainer)
    }
}

struct ContentView: View {
    @EnvironmentObject var container: DIContainer

    var body: some View {
        TabView {
            // æ—¢å­˜ã‚¿ãƒ–
            NavigationStack {
                PokemonListView(viewModel: container.makePokemonListViewModel())
            }
            .tabItem {
                Label("PokÃ©dex", systemImage: "book.fill")
            }

            NavigationStack {
                StatsCalculatorView(viewModel: container.makeStatsCalculatorViewModel())
            }
            .tabItem {
                Label("Stats", systemImage: "chart.bar.fill")
            }

            NavigationStack {
                DamageCalculatorView(store: container.makeDamageCalculatorStore())
            }
            .tabItem {
                Label("Damage", systemImage: "bolt.fill")
            }

            // â­ æ–°è¦: ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆã‚¿ãƒ–
            NavigationStack {
                PartyListView(viewModel: container.makePartyListViewModel())
            }
            .tabItem {
                Label("Party", systemImage: "person.3.fill")
            }
        }
    }
}
```

---

## ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
ScarletViolet-Pokedex-SwiftUI/
â”œâ”€â”€ Application/
â”‚   â””â”€â”€ DIContainer.swift                    [ä¿®æ­£] ãƒ‘ãƒ¼ãƒ†ã‚£é–¢é€£ã®ä¾å­˜æ³¨å…¥è¿½åŠ 
â”‚
â”œâ”€â”€ Domain/
â”‚   â”œâ”€â”€ Entities/
â”‚   â”‚   â”œâ”€â”€ Party.swift                      [æ–°è¦] ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ PartyMember.swift                [æ–°è¦] ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ Nature.swift                     [æ–°è¦] æ€§æ ¼enum
â”‚   â”‚   â”œâ”€â”€ StatValues.swift                 [æ–°è¦] èƒ½åŠ›å€¤æ§‹é€ ä½“
â”‚   â”‚   â”œâ”€â”€ TeraType.swift                   [æ–°è¦] ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—enum
â”‚   â”‚   â””â”€â”€ TypeCoverage.swift               [æ–°è¦] ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æ
â”‚   â”‚
â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â””â”€â”€ PartyRepositoryProtocol.swift    [æ–°è¦] ãƒ‘ãƒ¼ãƒ†ã‚£ãƒªãƒã‚¸ãƒˆãƒªIF
â”‚   â”‚
â”‚   â””â”€â”€ UseCases/
â”‚       â””â”€â”€ Party/                           [æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª]
â”‚           â”œâ”€â”€ FetchPartiesUseCase.swift    [æ–°è¦]
â”‚           â”œâ”€â”€ SavePartyUseCase.swift       [æ–°è¦]
â”‚           â”œâ”€â”€ DeletePartyUseCase.swift     [æ–°è¦]
â”‚           â””â”€â”€ AnalyzePartyUseCase.swift    [æ–°è¦]
â”‚
â”œâ”€â”€ Data/
â”‚   â”œâ”€â”€ Persistence/
â”‚   â”‚   â”œâ”€â”€ PartyModel.swift                 [æ–°è¦] SwiftDataãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â””â”€â”€ PartyMemberModel.swift           [æ–°è¦] SwiftDataãƒ¢ãƒ‡ãƒ«
â”‚   â”‚
â”‚   â”œâ”€â”€ DTOs/
â”‚   â”‚   â”œâ”€â”€ PartyMapper.swift                [æ–°è¦] ãƒ‰ãƒ¡ã‚¤ãƒ³â‡”ãƒ‡ãƒ¼ã‚¿å¤‰æ›
â”‚   â”‚   â””â”€â”€ PartyMemberMapper.swift          [æ–°è¦] ãƒ‰ãƒ¡ã‚¤ãƒ³â‡”ãƒ‡ãƒ¼ã‚¿å¤‰æ›
â”‚   â”‚
â”‚   â””â”€â”€ Repositories/
â”‚       â””â”€â”€ PartyRepository.swift            [æ–°è¦] ãƒ‘ãƒ¼ãƒ†ã‚£ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…
â”‚
â””â”€â”€ Presentation/
    â”œâ”€â”€ PartyFormation/                      [æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª]
    â”‚   â”œâ”€â”€ PartyListView.swift              [æ–°è¦] ä¸€è¦§ç”»é¢
    â”‚   â”œâ”€â”€ PartyListViewModel.swift         [æ–°è¦] ä¸€è¦§VM
    â”‚   â”œâ”€â”€ PartyFormationView.swift         [æ–°è¦] ç·¨æˆç”»é¢
    â”‚   â”œâ”€â”€ PartyFormationViewModel.swift    [æ–°è¦] ç·¨æˆVM
    â”‚   â”œâ”€â”€ PartyMemberEditorView.swift      [æ–°è¦] å€‹åˆ¥è¨­å®šç”»é¢
    â”‚   â”œâ”€â”€ PartyMemberEditorViewModel.swift [æ–°è¦] å€‹åˆ¥è¨­å®šVM
    â”‚   â”‚
    â”‚   â””â”€â”€ Components/                      [æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª]
    â”‚       â”œâ”€â”€ PartyCardView.swift          [æ–°è¦] ãƒ‘ãƒ¼ãƒ†ã‚£ã‚«ãƒ¼ãƒ‰
    â”‚       â”œâ”€â”€ PartyMemberSlotView.swift    [æ–°è¦] ãƒ¡ãƒ³ãƒãƒ¼ã‚¹ãƒ­ãƒƒãƒˆ
    â”‚       â”œâ”€â”€ TeraTypePicker.swift         [æ–°è¦] ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—é¸æŠUI
    â”‚       â”œâ”€â”€ TeraTypeBadge.swift          [æ–°è¦] ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸
    â”‚       â”œâ”€â”€ TypeAnalysisView.swift       [æ–°è¦] ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æè¡¨ç¤º
    â”‚       â”œâ”€â”€ MoveSelectorView.swift       [æ–°è¦] æŠ€é¸æŠUI
    â”‚       â”œâ”€â”€ StatsConfigView.swift        [æ–°è¦] èƒ½åŠ›å€¤è¨­å®šUI
    â”‚       â”œâ”€â”€ NaturePicker.swift           [æ–°è¦] æ€§æ ¼é¸æŠUI
    â”‚       â””â”€â”€ PokemonSelectorSheet.swift   [æ–°è¦] ãƒã‚±ãƒ¢ãƒ³é¸æŠã‚·ãƒ¼ãƒˆ
    â”‚
    â””â”€â”€ PokedexApp.swift                     [ä¿®æ­£] æ–°è¦ã‚¿ãƒ–è¿½åŠ 
```

---

## ğŸ“Š å®Ÿè£…è¨ˆç”»

### Phase 1: Domain Layerï¼ˆã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ï¼‰

1. âœ… `TeraType` enumå®šç¾©
2. âœ… `Nature` enumå®šç¾©
3. âœ… `StatValues` æ§‹é€ ä½“
4. âœ… `Party` ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
5. âœ… `PartyMember` ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
6. âœ… `TypeCoverage` æ§‹é€ ä½“
7. âœ… `PartyRepositoryProtocol` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
8. âœ… UseCaseså®Ÿè£…ï¼ˆ5ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

### Phase 2: Data Layerï¼ˆæ°¸ç¶šåŒ–ï¼‰

9. âœ… `PartyModel` SwiftDataãƒ¢ãƒ‡ãƒ«
10. âœ… `PartyMemberModel` SwiftDataãƒ¢ãƒ‡ãƒ«
11. âœ… `PartyMapper` å®Ÿè£…
12. âœ… `PartyMemberMapper` å®Ÿè£…
13. âœ… `PartyRepository` å®Ÿè£…

### Phase 3: Presentation Layer - åŸºæœ¬UI

14. âœ… `PartyListView` + ViewModel
15. âœ… `PartyCardView` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
16. âœ… `PartyFormationView` + ViewModel
17. âœ… `PartyMemberSlotView` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### Phase 4: Presentation Layer - ãƒ†ãƒ©ã‚¹ã‚¿ãƒ« UI

18. âœ… `TeraTypePicker` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
19. âœ… `TeraTypeBadge` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
20. âœ… `TypeAnalysisView` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### Phase 5: Presentation Layer - è©³ç´°è¨­å®š

21. âœ… `PartyMemberEditorView` + ViewModel
22. âœ… `MoveSelectorView` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
23. âœ… `StatsConfigView` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
24. âœ… `NaturePicker` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
25. âœ… `PokemonSelectorSheet` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### Phase 6: é€£æºæ©Ÿèƒ½

26. âœ… ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æãƒ­ã‚¸ãƒƒã‚¯
27. âœ… ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—æ©Ÿé€£æº
28. âœ… DIContainerçµ±åˆ

### Phase 7: ä»•ä¸Šã’

29. âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
30. âœ… ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ—¥æœ¬èª/è‹±èªï¼‰
31. âœ… UI/UXæ”¹å–„
32. âœ… ãƒ†ã‚¹ãƒˆ

---

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½ã®å®Ÿè£…è©³ç´°

### 1. ãƒ†ãƒ©ã‚¹ã‚¿ã‚¤ãƒ—é¸æŠã‚·ã‚¹ãƒ†ãƒ 

**ä»•æ§˜:**
- 18ã‚¿ã‚¤ãƒ—ã‹ã‚‰1ã¤é¸æŠ
- å…ƒã®ã‚¿ã‚¤ãƒ—ã«ã¯æ˜Ÿãƒãƒ¼ã‚¯è¡¨ç¤º
- ã‚¯ãƒªã‚¹ã‚¿ãƒ«é¢¨ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³

### 2. ã‚¿ã‚¤ãƒ—ç›¸æ€§åˆ†æ

**åˆ†æé …ç›®:**
- ãƒ‘ãƒ¼ãƒ†ã‚£å…¨ä½“ã®å¼±ç‚¹é›†è¨ˆ
- ãƒ‘ãƒ¼ãƒ†ã‚£å…¨ä½“ã®è€æ€§é›†è¨ˆ
- æ”»æ’ƒç¯„å›²ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚¹ã‚³ã‚¢
- ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«è€ƒæ…®ã®åˆ†æ

### 3. èƒ½åŠ›å€¤è¨ˆç®—

**è¨ˆç®—å¼:**
```
å®Ÿæ•°å€¤ = floor((ç¨®æ—å€¤ Ã— 2 + å€‹ä½“å€¤ + floor(åŠªåŠ›å€¤ / 4)) Ã— ãƒ¬ãƒ™ãƒ« / 100) + ãƒ¬ãƒ™ãƒ« + 10
â€» HPä»¥å¤–ã¯æ€§æ ¼è£œæ­£ã‚‚é©ç”¨
```

### 4. ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

**SwiftDataæˆ¦ç•¥:**
- `PartyModel` ã¨ `PartyMemberModel` ã‚’ `@Model` ã¨ã—ã¦å®šç¾©
- JSON Encodingã§è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ï¼ˆæŠ€ã€èƒ½åŠ›å€¤ï¼‰ã‚’Dataå‹ã§ä¿å­˜
- æ›´æ–°æ™‚ã¯ `updatedAt` ã‚’è‡ªå‹•æ›´æ–°

---

## ğŸ”„ å°†æ¥ã®æ‹¡å¼µå¯èƒ½æ€§

### çŸ­æœŸ

- [ ] ãƒ‘ãƒ¼ãƒ†ã‚£ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ/ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆJSONå½¢å¼ï¼‰
- [ ] Showdownã‚„Poryboxå½¢å¼ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯¾å¿œ
- [ ] ãƒ‘ãƒ¼ãƒ†ã‚£ã®QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

### ä¸­æœŸ

- [ ] ã‚¿ã‚¤ãƒ—ç›¸æ€§ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«åŒ–ï¼ˆãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼‰
- [ ] ãƒ‘ãƒ¼ãƒ†ã‚£åŒå£«ã®å¯¾æˆ¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] æŠ€ç¯„å›²ã®å¯è¦–åŒ–

### é•·æœŸ

- [ ] ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- [ ] ãƒ‘ãƒ¼ãƒ†ã‚£ã®å…±æœ‰æ©Ÿèƒ½
- [ ] AI ã«ã‚ˆã‚‹ãƒ‘ãƒ¼ãƒ†ã‚£ææ¡ˆ

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] è¦ä»¶å®šç¾©å®Œäº†
- [x] ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­è¨ˆå®Œäº†
- [x] ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–è¨­è¨ˆå®Œäº†
- [x] UIè¨­è¨ˆå®Œäº†
- [x] ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆå®šç¾©å®Œäº†
- [ ] å®Ÿè£…é–‹å§‹æº–å‚™å®Œäº†

---

**æœ€çµ‚æ›´æ–°**: 2025-11-09
**ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼**: -
**æ‰¿èª**: -
